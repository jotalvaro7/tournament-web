<div class="animate-fade-in">
  <div class="max-w-7xl mx-auto">
    <!-- Header -->
    <div class="card px-6 py-4 mb-6">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-3">
          <div class="w-8 h-8 rounded-lg flex items-center justify-center bg-gray-900">
            <i class="fas fa-futbol text-white text-sm"></i>
          </div>
          <div>
            <h1 class="text-lg font-bold text-gray-900">Matches</h1>
            <p class="text-xs text-gray-500">{{ matches().length }} shown</p>
          </div>
        </div>
        <button (click)="onCreateMatch()" class="btn-primary">
          <i class="fas fa-plus mr-2"></i> Add Match
        </button>
      </div>
    </div>

    <!-- Filters -->
    <app-match-filters
      (filterChange)="onFilterChange($event)"
    />

    <!-- Form Modal -->
    @if (showForm()) {
      <div
        class="modal-overlay"
        (click)="closeForm()"
      >
        <div
          class="max-w-2xl w-full max-h-[90vh] overflow-y-auto"
          (click)="$event.stopPropagation()"
        >
          <app-match-form
            [match]="selectedMatch()"
            [teams]="teams()"
            [mode]="formMode()"
            (matchSubmit)="onMatchSubmit($event)"
            (resultSubmit)="onResultSubmit($event)"
            (cancel)="closeForm()"
          />
        </div>
      </div>
    }

    <!-- Details Modal -->
    @if (matchService.selectedMatch(); as selectedMatch) {
      <app-match-details-modal
        [match]="selectedMatch"
        [homeTeamName]="getTeamName(selectedMatch.homeTeamId)"
        [awayTeamName]="getTeamName(selectedMatch.awayTeamId)"
        (close)="closeDetails()"
        (edit)="onEditMatch($event)"
        (finish)="onFinishMatch($event)"
        (delete)="onDeleteMatch($event)"
        (postpone)="onPostponeMatch($event)"
      />
    }

    <!-- Loading State -->
    @if (isLoading()) {
      <div class="flex justify-center items-center py-20">
        <div class="text-center">
          <div class="spinner mx-auto mb-6"></div>
          <p class="text-gray-500 font-medium">Cargando partidos...</p>
        </div>
      </div>
    }

    <!-- Initial State - No search performed yet -->
    @else if (!hasSearched() && !isLoading()) {
      <div class="card p-16">
        <div class="empty-state">
          <i class="fas fa-filter empty-state-icon"></i>
          <h3 class="empty-state-title">Selecciona un filtro</h3>
          <p class="empty-state-description">
            Utiliza los filtros para buscar partidos por estado, fecha espec√≠fica o rango de fechas.
          </p>
        </div>
      </div>
    }

    <!-- Empty State - Search performed but no results -->
    @else if (matches().length === 0 && !isLoading() && hasSearched()) {
      <div class="card p-16">
        <div class="empty-state">
          <i class="fas fa-calendar-times empty-state-icon"></i>
          <h3 class="empty-state-title">No hay partidos</h3>
          <p class="empty-state-description">
            No se encontraron partidos con los filtros seleccionados.
          </p>
        </div>
      </div>
    }

    <!-- Matches List -->
    @else {
      <div class="card overflow-hidden mb-6">
        <table class="w-full">
          <thead>
            <tr>
              <th class="table-header text-left">Home</th>
              <th class="table-header text-center">Score</th>
              <th class="table-header text-left">Away</th>
              <th class="table-header text-left hidden md:table-cell">Date</th>
              <th class="table-header text-left hidden sm:table-cell">Status</th>
            </tr>
          </thead>
          <tbody>
            @for (match of matches(); track match.id) {
              <app-match-card
                [match]="match"
                [homeTeamName]="getTeamName(match.homeTeamId)"
                [awayTeamName]="getTeamName(match.awayTeamId)"
                (cardClick)="onMatchClick($event)"
              />
            }
          </tbody>
        </table>
      </div>

      <!-- Pagination -->
      <app-match-pagination
        [currentPage]="pagination().page"
        [totalPages]="pagination().totalPages"
        [totalElements]="pagination().totalElements"
        [hasNext]="pagination().hasNext"
        [hasPrevious]="pagination().hasPrevious"
        (pageChange)="onPageChange($event)"
      />
    }
  </div>
</div>
